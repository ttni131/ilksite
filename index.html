<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ttni Network | Neon Auth & Market</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { 
            background: #080a0f url('https://w0.peakpx.com/wallpaper/596/1020/wallpaper-desktop-background-abstract-dark-blue.jpg') no-repeat center center fixed; 
            background-size: cover; color: white; min-height: 100vh;
        }

        nav { 
            background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(15px);
            padding: 15px 10%; display: flex; justify-content: space-between; align-items: center; 
            position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid rgba(0, 210, 255, 0.2);
        }

        .auth-buttons .login-btn { 
            color: white; background: none; border: 1px solid #00d2ff; padding: 7px 20px; 
            border-radius: 20px; cursor: pointer; transition: 0.3s; box-shadow: 0 0 10px rgba(0, 210, 255, 0.2);
        }
        .login-btn:hover { background: #00d2ff; color: #000; box-shadow: 0 0 20px #00d2ff; }

        header { text-align: center; padding: 60px 10%; }
        header h1 { font-size: 3.5rem; font-weight: 900; background: linear-gradient(to right, #00d2ff, #00ff88); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* Auth Form Tasarımı */
        .auth-card { background: rgba(13, 17, 23, 0.95); border: 1px solid #00d2ff; padding: 2rem; border-radius: 20px; color: white; }
        .neon-input { background: rgba(255,255,255,0.05); border: 1px solid rgba(0,210,255,0.3); padding: 12px; border-radius: 10px; color: white; width: 100%; margin-bottom: 15px; outline: none; }
        .neon-input:focus { border-color: #00d2ff; box-shadow: 0 0 10px rgba(0,210,255,0.5); }
    </style>
</head>
<body>

    <nav>
        <div style="font-weight: 900; color: #00d2ff;">TTNİ NETWORK</div>
        <div class="auth-buttons">
            <button class="login-btn" id="authBtn" onclick="handleAuthClick()">Giriş Yap / Kayıt Ol</button>
        </div>
    </nav>

    <header>
        <h1>TTNİ AUTH SİSTEMİ</h1>
        <p id="welcomeMsg" style="color: #888; margin-top: 10px;">Veritabanına bağlanmaya hazır.</p>
    </header>

    <script type="module">
        // Firebase Modülleri
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase Yapılandırması
        const firebaseConfig = {
            apiKey: "BURAYA_API_KEY_GELECEK",
            authDomain: "ttni-auth.firebaseapp.com",
            projectId: "ttni-auth",
            storageBucket: "ttni-auth.appspot.com",
            appId: "BURAYA_APP_ID_GELECEK"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Kullanıcı Durum Takibi
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('authBtn').innerText = "Çıkış Yap";
                document.getElementById('welcomeMsg').innerText = `Hoş geldin, ${user.email}!`;
            } else {
                document.getElementById('authBtn').innerText = "Giriş Yap / Kayıt Ol";
                document.getElementById('welcomeMsg').innerText = "Lütfen giriş yapın.";
            }
        });

        // Giriş/Kayıt Panelini Aç
        window.handleAuthClick = () => {
            if (auth.currentUser) {
                signOut(auth);
                return;
            }

            Swal.fire({
                title: '<span style="color:#00d2ff">TTNİ Auth</span>',
                html: `
                    <div class="auth-card">
                        <input type="email" id="email" class="neon-input" placeholder="E-posta">
                        <input type="password" id="password" class="neon-input" placeholder="Şifre">
                        <div style="display:flex; gap:10px; margin-top:10px;">
                            <button onclick="window.processAuth('login')" class="login-btn" style="flex:1">GİRİŞ</button>
                            <button onclick="window.processAuth('register')" class="login-btn" style="flex:1; border-color:#00ff88">KAYIT</button>
                        </div>
                    </div>
                `,
                showConfirmButton: false,
                background: 'transparent',
                color: '#fff'
            });
        };

        // Veritabanı İşlemleri
        window.processAuth = async (type) => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('password').value;

            try {
                if (type === 'register') {
                    const res = await createUserWithEmailAndPassword(auth, email, pass);
                    // Kullanıcıyı Firestore veritabanına kaydet
                    await setDoc(doc(db, "users", res.user.uid), {
                        email: email,
                        role: "member",
                        joinDate: new Date()
                    });
                    Swal.fire('Başarılı!', 'Hesabınız oluşturuldu ve veritabanına kaydedildi.', 'success');
                } else {
                    await signInWithEmailAndPassword(auth, email, pass);
                    Swal.fire('Başarılı!', 'Giriş yapıldı.', 'success');
                }
            } catch (error) {
                Swal.fire('Hata', error.message, 'error');
            }
        };
    </script>
</body>
</html>
